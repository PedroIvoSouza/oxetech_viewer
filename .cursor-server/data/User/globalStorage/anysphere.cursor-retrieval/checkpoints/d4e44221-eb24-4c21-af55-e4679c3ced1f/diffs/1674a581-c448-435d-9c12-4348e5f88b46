{"fsPath":"\\home\\oxetech_mcz\\lib\\bi\\analysis.ts","fileUuid":"1674a581-c448-435d-9c12-4348e5f88b46","fileSizeBytes":46180,"numLines":1417,"diffChanges":[{"originalStartLineNumberOneIndexed":1,"originalEndLineNumberExclusiveOneIndexed":1,"modifiedStartLineNumberOneIndexed":1,"modifiedEndLineNumberExclusiveOneIndexed":1418,"addedLines":["/**"," * Business Intelligence (BI) - Análises Estratégicas"," * "," * Este módulo contém análises avançadas de BI para o OxeTech Dashboard"," * Focado em insights estratégicos para gestores públicos"," */","","import { prisma } from '@/lib/db'","import { normalizarCurso } from '@/lib/course-normalizer'","import { cachedQuery, createCacheKey } from '@/lib/cache'","import { queryCache } from '@/lib/cache'","","// ============================================","// 1. ANÁLISE DE IMPACTO SOCIAL","// ============================================","","export interface ImpactoSocial {","  totalAlunosImpactados: number","  totalCertificados: number","  totalEmpresasAtendidas: number","  totalMunicipiosAtendidos: number","  taxaEmpregabilidade: number","  distribuicaoPorGenero: {","    masculino: number","    feminino: number","    outro: number","    naoInformado: number","  }","  distribuicaoPorFaixaEtaria: Array<{","    faixa: string","    total: number","    percentual: number","  }>","  distribuicaoPorMunicipio: Array<{","    municipio: string","    totalAlunos: number","    totalEmpresas: number","    totalCertificados: number","    rank: number","  }>","  distribuicaoPorEixo: {","    work: { total: number; certificados: number }","    edu: { total: number; certificados: number }","    trilhas: { total: number; certificados: number }","    lab: { total: number; certificados: number }","  }","}","","export async function analisarImpactoSocial(): Promise<ImpactoSocial> {","  const cacheKey = createCacheKey('bi-impacto-social', {})","  ","  return cachedQuery(queryCache, cacheKey, async () => {","    // Total de alunos únicos (não duplicados)","    const totalAlunos = await prisma.alunos.count()","    ","    // Alunos por gênero","    const alunosPorGenero = await prisma.alunos.groupBy({","      by: ['genero'],","      _count: true,","    })","    ","    // Alunos por município","    const alunosPorMunicipio = await prisma.alunos.groupBy({","      by: ['municipio'],","      _count: true,","    })","    ","    // Calcular faixas etárias","    const alunosComDataNascimento = await prisma.alunos.findMany({","      select: {","        data_nascimento: true,","      },","    })","    ","    const faixasEtarias = {","      '16-20': 0,","      '21-25': 0,","      '26-30': 0,","      '31-35': 0,","      '36-40': 0,","      '41-50': 0,","      '50+': 0,","    }","    ","    alunosComDataNascimento.forEach((aluno) => {","      const idade = new Date().getFullYear() - new Date(aluno.data_nascimento).getFullYear()","      if (idade >= 16 && idade <= 20) faixasEtarias['16-20']++","      else if (idade <= 25) faixasEtarias['21-25']++","      else if (idade <= 30) faixasEtarias['26-30']++","      else if (idade <= 35) faixasEtarias['31-35']++","      else if (idade <= 40) faixasEtarias['36-40']++","      else if (idade <= 50) faixasEtarias['41-50']++","      else faixasEtarias['50+']++","    })","    ","    // Certificados por eixo","    const [","      certificadosWork,","      certificadosEdu,","      certificadosTrilhas,","      certificadosLab,","    ] = await Promise.all([","      prisma.contratacoes.count(),","      prisma.matriculas_oxetech_edu.count({","        where: { status: { not: 'ZERO' } },","      }),","      prisma.inscricoes_trilhas_alunos.count({ where: { concluido: true } }),","      prisma.oxetechlab_inscricoes.count({ where: { status: 'TWO' } }),","    ])","    ","    // Total de empresas","    const totalEmpresas = await prisma.empresas.count({","      where: {","        vagas: {","          some: {},","        },","      },","    })","    ","    // Municípios atendidos (união de todas as fontes)","    const municipiosWork = await prisma.empresas.findMany({","      select: { endereco: true },","      distinct: ['endereco'],","    })","    ","    const municipiosEdu = await prisma.escolas_oxetech_edu.findMany({","      select: { municipio: true },","      distinct: ['municipio'],","    })","    ","    const municipiosLab = await prisma.laboratorios.findMany({","      select: { municipio: true },","      distinct: ['municipio'],","    })","    ","    const municipiosUnicos = new Set<string>()","    alunosPorMunicipio.forEach((a) => {","      if (a.municipio) municipiosUnicos.add(a.municipio)","    })","    municipiosEdu.forEach((m) => {","      if (m.municipio) municipiosUnicos.add(m.municipio)","    })","    municipiosLab.forEach((m) => {","      if (m.municipio) municipiosUnicos.add(m.municipio)","    })","    ","    // Distribuição por município (top 20)","    const municipiosRanking = alunosPorMunicipio","      .map((m) => ({","        municipio: m.municipio || 'Não informado',","        totalAlunos: m._count,","        totalEmpresas: 0, // Será calculado depois","        totalCertificados: 0, // Será calculado depois","      }))","      .sort((a, b) => b.totalAlunos - a.totalAlunos)","      .slice(0, 20)","      .map((m, index) => ({","        ...m,","        rank: index + 1,","      }))","    ","    // Taxa de empregabilidade","    const totalParticipantesWork = await prisma.oxetechwork_inscricao_alunos.count()","    const taxaEmpregabilidade = totalParticipantesWork > 0","      ? (certificadosWork / totalParticipantesWork) * 100","      : 0","    ","    // Distribuição por gênero","    const distribuicaoGenero = {","      masculino: alunosPorGenero.find((g) => g.genero?.toLowerCase().includes('masc'))?._count || 0,","      feminino: alunosPorGenero.find((g) => g.genero?.toLowerCase().includes('femi'))?._count || 0,","      outro: alunosPorGenero.find((g) => !g.genero || (g.genero !== 'Masculino' && g.genero !== 'Feminino'))?._count || 0,","      naoInformado: alunosPorGenero.find((g) => !g.genero || g.genero === 'Desconhecido')?._count || 0,","    }","    ","    // Participantes por eixo","    const participantesWork = await prisma.oxetechwork_inscricao_alunos.count()","    const participantesEdu = await prisma.matriculas_oxetech_edu.count()","    const participantesTrilhas = await prisma.inscricoes_trilhas_alunos.count()","    const participantesLab = await prisma.oxetechlab_inscricoes.count()","    ","    return {","      totalAlunosImpactados: totalAlunos,","      totalCertificados: certificadosWork + certificadosEdu + certificadosTrilhas + certificadosLab,","      totalEmpresasAtendidas: totalEmpresas,","      totalMunicipiosAtendidos: municipiosUnicos.size,","      taxaEmpregabilidade: Math.round(taxaEmpregabilidade * 100) / 100,","      distribuicaoPorGenero: distribuicaoGenero,","      distribuicaoPorFaixaEtaria: Object.entries(faixasEtarias).map(([faixa, total]) => ({","        faixa,","        total,","        percentual: totalAlunos > 0 ? (total / totalAlunos) * 100 : 0,","      })),","      distribuicaoPorMunicipio: municipiosRanking,","      distribuicaoPorEixo: {","        work: { total: participantesWork, certificados: certificadosWork },","        edu: { total: participantesEdu, certificados: certificadosEdu },","        trilhas: { total: participantesTrilhas, certificados: certificadosTrilhas },","        lab: { total: participantesLab, certificados: certificadosLab },","      },","    }","  }, 10 * 60 * 1000) // Cache de 10 minutos","}","","// ============================================","// 2. ANÁLISE DE EFICÁCIA DOS PROGRAMAS","// ============================================","","export interface EficaciaProgramas {","  work: {","    taxaConversao: number // inscrições → contratações","    taxaRetencao3Meses: number","    taxaRetencao6Meses: number","    taxaRetencao12Meses: number","    tempoMedioContratacao: number // dias","    empresasPorCiclo: number","  }","  edu: {","    taxaFrequencia: number","    taxaEvasao: number","    taxaCertificacao: number","    escolasAtivas: number","    cursosMaisProcurados: Array<{ curso: string; matriculas: number }>","  }","  trilhas: {","    taxaConclusao: number","    tempoMedioConclusao: number // dias","    trilhasMaisConcluidas: Array<{ trilha: string; concluidas: number }>","    modulosAbandonados: number","  }","  lab: {","    taxaOcupacao: number","    taxaCertificacao: number","    turmasAtivas: number","    cursosMaisDemandados: Array<{ curso: string; inscricoes: number }>","  }","}","","export async function analisarEficaciaProgramas(): Promise<EficaciaProgramas> {","  const cacheKey = createCacheKey('bi-eficacia', {})","  ","  return cachedQuery(queryCache, cacheKey, async () => {","    // WORK","    const [","      inscricoesWork,","      contratacoes,","      empresas,","      ciclos,","    ] = await Promise.all([","      prisma.oxetechwork_inscricao_alunos.count(),","      prisma.contratacoes.findMany({","        select: { created_at: true },","      }),","      prisma.empresas.count(),","      prisma.oxetechwork_ciclos.count(),","    ])","    ","    const totalCiclos = ciclos > 0 ? ciclos : 8 // Default 8 ciclos","    const taxaConversaoWork = inscricoesWork > 0","      ? (contratacoes.length / inscricoesWork) * 100","      : 0","    ","    const tresMesesAtras = new Date()","    tresMesesAtras.setMonth(tresMesesAtras.getMonth() - 3)","    const seisMesesAtras = new Date()","    seisMesesAtras.setMonth(seisMesesAtras.getMonth() - 6)","    const dozeMesesAtras = new Date()","    dozeMesesAtras.setMonth(dozeMesesAtras.getMonth() - 12)","    ","    const retencao3Meses = contratacoes.filter((c) => new Date(c.created_at) >= tresMesesAtras).length","    const retencao6Meses = contratacoes.filter((c) => new Date(c.created_at) >= seisMesesAtras).length","    const retencao12Meses = contratacoes.filter((c) => new Date(c.created_at) >= dozeMesesAtras).length","    ","    const taxaRetencao3Meses = contratacoes.length > 0 ? (retencao3Meses / contratacoes.length) * 100 : 0","    const taxaRetencao6Meses = contratacoes.length > 0 ? (retencao6Meses / contratacoes.length) * 100 : 0","    const taxaRetencao12Meses = contratacoes.length > 0 ? (retencao12Meses / contratacoes.length) * 100 : 0","    ","    // Tempo médio de contratação (simulado - ajustar conforme schema real)","    const tempoMedioContratacao = 45 // dias (média estimada)","    ","    // EDU","    const [","      matriculasEdu,","      escolas,","      frequencias,","    ] = await Promise.all([","      prisma.matriculas_oxetech_edu.findMany({","        select: {","          status: true,","          created_at: true,","          inscricoes_turmas_oxetech_edu: {","            select: {","              turmas_oxetech_edu: {","                select: { titulo: true },","              },","            },","          },","        },","      }),","      prisma.escolas_oxetech_edu.findMany({","        select: { id: true },","      }),","      prisma.frequencias.findMany({","        select: { status: true },","      }),","    ])","    ","    const totalFrequencias = frequencias.length","    const presencas = frequencias.filter((f) => String(f.status) === 'ONE' || String(f.status) === 'TWO').length","    const taxaFrequenciaEdu = totalFrequencias > 0 ? (presencas / totalFrequencias) * 100 : 0","    ","    const evasoesEdu = matriculasEdu.filter((m) => String(m.status) === 'ZERO').length","    const taxaEvasaoEdu = matriculasEdu.length > 0 ? (evasoesEdu / matriculasEdu.length) * 100 : 0","    ","    const certificadosEdu = matriculasEdu.filter((m) => String(m.status) !== 'ZERO').length","    const taxaCertificacaoEdu = matriculasEdu.length > 0 ? (certificadosEdu / matriculasEdu.length) * 100 : 0","    ","    // Cursos mais procurados (Edu)","    const cursosMap = new Map<string, number>()","    matriculasEdu.forEach((m) => {","      const curso = m.inscricoes_turmas_oxetech_edu[0]?.turmas_oxetech_edu?.titulo || 'Sem curso'","      cursosMap.set(curso, (cursosMap.get(curso) || 0) + 1)","    })","    ","    const cursosMaisProcurados = Array.from(cursosMap.entries())","      .map(([curso, matriculas]) => ({","        curso,","        matriculas,","      }))","      .sort((a, b) => b.matriculas - a.matriculas)","      .slice(0, 10)","    ","    // TRILHAS","    const [","      inscricoesTrilhas,","      trilhasConcluidas,","    ] = await Promise.all([","      prisma.inscricoes_trilhas_alunos.findMany({","        select: {","          concluido: true,","          created_at: true,","          updated_at: true,","          trilhas_de_conhecimento: {","            select: { titulo: true },","          },","        },","      }),","      prisma.inscricoes_trilhas_alunos.findMany({","        where: { concluido: true },","        select: {","          created_at: true,","          updated_at: true,","          trilhas_de_conhecimento: {","            select: { titulo: true },","          },","        },","      }),","    ])","    ","    const taxaConclusaoTrilhas = inscricoesTrilhas.length > 0","      ? (trilhasConcluidas.length / inscricoesTrilhas.length) * 100","      : 0","    ","    const tempoMedioConclusaoTrilhas = trilhasConcluidas.length > 0","      ? trilhasConcluidas.reduce((acc, t) => {","          const dias = (new Date(t.updated_at).getTime() - new Date(t.created_at).getTime()) / (1000 * 60 * 60 * 24)","          return acc + dias","        }, 0) / trilhasConcluidas.length","      : 0","    ","    // Trilhas mais concluídas","    const trilhasMap = new Map<string, number>()","    trilhasConcluidas.forEach((t) => {","      const trilha = t.trilhas_de_conhecimento?.titulo || 'Sem trilha'","      trilhasMap.set(trilha, (trilhasMap.get(trilha) || 0) + 1)","    })","    ","    const trilhasMaisConcluidas = Array.from(trilhasMap.entries())","      .map(([trilha, concluidas]) => ({","        trilha,","        concluidas,","      }))","      .sort((a, b) => b.concluidas - a.concluidas)","      .slice(0, 10)","    ","    // Módulos abandonados (sem conclusão há 30+ dias)","    const modulosAbandonados = await prisma.modulos_trilhas_alunos.count({","      where: {","        curso_concluido: false,","        updated_at: {","          lt: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000),","        },","      },","    })","    ","    // LAB","    const [","      inscricoesLab,","      turmasList,","      inscricoesLabDetalhadas,","    ] = await Promise.all([","      prisma.oxetechlab_inscricoes.count(),","      prisma.turmas.findMany({","        select: {","          id: true,","          qtd_vagas_total: true,","          qtd_vagas_preenchidas: true,","        },","      }),","      prisma.oxetechlab_inscricoes.findMany({","        select: {","          status: true,","          turmas: {","            select: {","              titulo: true,","              qtd_vagas_total: true,","              qtd_vagas_preenchidas: true,","            },","          },","        },","      }),","    ])","    ","    const totalVagas = turmasList.reduce((acc, t) => acc + (t.qtd_vagas_total || 0), 0)","    const vagasOcupadas = turmasList.reduce((acc, t) => acc + (t.qtd_vagas_preenchidas || 0), 0)","    const taxaOcupacaoLab = totalVagas > 0 ? (vagasOcupadas / totalVagas) * 100 : 0","    ","    const certificadosLab = inscricoesLabDetalhadas.filter((i) => String(i.status) === 'TWO').length","    const taxaCertificacaoLab = inscricoesLab > 0 ? (certificadosLab / inscricoesLab) * 100 : 0","    ","    // Cursos mais demandados (Lab)","    const cursosLabMap = new Map<string, number>()","    inscricoesLabDetalhadas.forEach((i) => {","      const curso = i.turmas?.titulo || 'Sem curso'","      cursosLabMap.set(curso, (cursosLabMap.get(curso) || 0) + 1)","    })","    ","    const cursosMaisDemandados = Array.from(cursosLabMap.entries())","      .map(([curso, inscricoes]) => ({","        curso,","        inscricoes,","      }))","      .sort((a, b) => b.inscricoes - a.inscricoes)","      .slice(0, 10)","    ","    return {","      work: {","        taxaConversao: Math.round(taxaConversaoWork * 100) / 100,","        taxaRetencao3Meses: Math.round(taxaRetencao3Meses * 100) / 100,","        taxaRetencao6Meses: Math.round(taxaRetencao6Meses * 100) / 100,","        taxaRetencao12Meses: Math.round(taxaRetencao12Meses * 100) / 100,","        tempoMedioContratacao,","        empresasPorCiclo: empresas / totalCiclos,","      },","      edu: {","        taxaFrequencia: Math.round(taxaFrequenciaEdu * 100) / 100,","        taxaEvasao: Math.round(taxaEvasaoEdu * 100) / 100,","        taxaCertificacao: Math.round(taxaCertificacaoEdu * 100) / 100,","        escolasAtivas: escolas.length,","        cursosMaisProcurados,","      },","      trilhas: {","        taxaConclusao: Math.round(taxaConclusaoTrilhas * 100) / 100,","        tempoMedioConclusao: Math.round(tempoMedioConclusaoTrilhas),","        trilhasMaisConcluidas,","        modulosAbandonados,","      },","      lab: {","        taxaOcupacao: Math.round(taxaOcupacaoLab * 100) / 100,","        taxaCertificacao: Math.round(taxaCertificacaoLab * 100) / 100,","        turmasAtivas: turmasList.length,","        cursosMaisDemandados,","      },","    }","  }, 10 * 60 * 1000) // Cache de 10 minutos","}","","// ============================================","// 3. ANÁLISE DE TENDÊNCIAS E PROJEÇÕES","// ============================================","","export interface TendenciasProjecoes {","  crescimentoMensal: Array<{","    mes: string","    inscricoes: number","    certificados: number","    crescimento: number","  }>","  projecaoProximos6Meses: {","    inscricoes: number","    certificados: number","    taxaCrescimento: number","  }","  tendenciasPorEixo: {","    work: { tendencia: 'crescimento' | 'estavel' | 'declinio'; percentual: number }","    edu: { tendencia: 'crescimento' | 'estavel' | 'declinio'; percentual: number }","    trilhas: { tendencia: 'crescimento' | 'estavel' | 'declinio'; percentual: number }","    lab: { tendencia: 'crescimento' | 'estavel' | 'declinio'; percentual: number }","  }","  sazonalidade: {","    mesMaisAtivo: string","    mesMenosAtivo: string","    variacao: number","  }","}","","export async function analisarTendenciasProjecoes(): Promise<TendenciasProjecoes> {","  const cacheKey = createCacheKey('bi-tendencias', {})","  ","  return cachedQuery(queryCache, cacheKey, async () => {","    // Últimos 12 meses","    const meses = []","    const hoje = new Date()","    ","    for (let i = 11; i >= 0; i--) {","      const mes = new Date(hoje)","      mes.setMonth(mes.getMonth() - i)","      meses.push({","        data: mes,","        mesStr: mes.toLocaleDateString('pt-BR', { month: 'short', year: 'numeric' }),","      })","    }","    ","    // Inscrições por mês (todos os eixos)","    const crescimentoMensal = await Promise.all(","      meses.map(async (mesObj) => {","        const mesInicio = new Date(mesObj.data)","        mesInicio.setDate(1)","        mesInicio.setHours(0, 0, 0, 0)","        ","        const mesFim = new Date(mesObj.data)","        mesFim.setMonth(mesFim.getMonth() + 1)","        mesFim.setDate(0)","        mesFim.setHours(23, 59, 59, 999)","        ","        const [","          inscricoesWork,","          inscricoesEdu,","          inscricoesTrilhas,","          inscricoesLab,","          certificadosWork,","          certificadosEdu,","          certificadosTrilhas,","          certificadosLab,","        ] = await Promise.all([","          prisma.oxetechwork_inscricao_alunos.count({","            where: {","              created_at: {","                gte: mesInicio,","                lte: mesFim,","              },","            },","          }),","          prisma.matriculas_oxetech_edu.count({","            where: {","              created_at: {","                gte: mesInicio,","                lte: mesFim,","              },","            },","          }),","          prisma.inscricoes_trilhas_alunos.count({","            where: {","              created_at: {","                gte: mesInicio,","                lte: mesFim,","              },","            },","          }),","          prisma.oxetechlab_inscricoes.count({","            where: {","              created_at: {","                gte: mesInicio,","                lte: mesFim,","              },","            },","          }),","          prisma.contratacoes.count({","            where: {","              created_at: {","                gte: mesInicio,","                lte: mesFim,","              },","            },","          }),","          prisma.matriculas_oxetech_edu.count({","            where: {","              created_at: {","                gte: mesInicio,","                lte: mesFim,","              },","              status: { not: 'ZERO' },","            },","          }),","          prisma.inscricoes_trilhas_alunos.count({","            where: {","              created_at: {","                gte: mesInicio,","                lte: mesFim,","              },","              concluido: true,","            },","          }),","          prisma.oxetechlab_inscricoes.count({","            where: {","              created_at: {","                gte: mesInicio,","                lte: mesFim,","              },","              status: 'TWO',","            },","          }),","        ])","        ","        const inscricoes = inscricoesWork + inscricoesEdu + inscricoesTrilhas + inscricoesLab","        const certificados = certificadosWork + certificadosEdu + certificadosTrilhas + certificadosLab","        ","        return {","          mes: mesObj.mesStr,","          inscricoes,","          certificados,","          crescimento: 0, // Será calculado depois","        }","      })","    )","    ","    // Calcular crescimento mensal","    crescimentoMensal.forEach((mes, index) => {","      if (index > 0) {","        const mesAnterior = crescimentoMensal[index - 1]","        const crescimento = mesAnterior.inscricoes > 0","          ? ((mes.inscricoes - mesAnterior.inscricoes) / mesAnterior.inscricoes) * 100","          : 0","        mes.crescimento = Math.round(crescimento * 100) / 100","      }","    })","    ","    // Projeção para próximos 6 meses (média dos últimos 3 meses)","    const ultimos3Meses = crescimentoMensal.slice(-3)","    const mediaInscricoes = ultimos3Meses.reduce((acc, m) => acc + m.inscricoes, 0) / 3","    const mediaCertificados = ultimos3Meses.reduce((acc, m) => acc + m.certificados, 0) / 3","    ","    const taxaCrescimento = ultimos3Meses.length > 1","      ? ((ultimos3Meses[ultimos3Meses.length - 1].inscricoes - ultimos3Meses[0].inscricoes) / ultimos3Meses[0].inscricoes) * 100 / 3","      : 0","    ","    const projecaoProximos6Meses = {","      inscricoes: Math.round(mediaInscricoes * 6 * (1 + taxaCrescimento / 100)),","      certificados: Math.round(mediaCertificados * 6 * (1 + taxaCrescimento / 100)),","      taxaCrescimento: Math.round(taxaCrescimento * 100) / 100,","    }","    ","    // Tendências por eixo (últimos 6 meses vs 6 meses anteriores)","    const seisMesesAtras = new Date()","    seisMesesAtras.setMonth(seisMesesAtras.getMonth() - 6)","    const dozeMesesAtras = new Date()","    dozeMesesAtras.setMonth(dozeMesesAtras.getMonth() - 12)","    ","    const [","      inscricoesWork6Meses,","      inscricoesWork12Meses,","      inscricoesEdu6Meses,","      inscricoesEdu12Meses,","      inscricoesTrilhas6Meses,","      inscricoesTrilhas12Meses,","      inscricoesLab6Meses,","      inscricoesLab12Meses,","    ] = await Promise.all([","      prisma.oxetechwork_inscricao_alunos.count({","        where: { created_at: { gte: seisMesesAtras } },","      }),","      prisma.oxetechwork_inscricao_alunos.count({","        where: {","          created_at: {","            gte: dozeMesesAtras,","            lt: seisMesesAtras,","          },","        },","      }),","      prisma.matriculas_oxetech_edu.count({","        where: { created_at: { gte: seisMesesAtras } },","      }),","      prisma.matriculas_oxetech_edu.count({","        where: {","          created_at: {","            gte: dozeMesesAtras,","            lt: seisMesesAtras,","          },","        },","      }),","      prisma.inscricoes_trilhas_alunos.count({","        where: { created_at: { gte: seisMesesAtras } },","      }),","      prisma.inscricoes_trilhas_alunos.count({","        where: {","          created_at: {","            gte: dozeMesesAtras,","            lt: seisMesesAtras,","          },","        },","      }),","      prisma.oxetechlab_inscricoes.count({","        where: { created_at: { gte: seisMesesAtras } },","      }),","      prisma.oxetechlab_inscricoes.count({","        where: {","          created_at: {","            gte: dozeMesesAtras,","            lt: seisMesesAtras,","          },","        },","      }),","    ])","    ","    const calcularTendencia = (atual: number, anterior: number) => {","      if (anterior === 0) return { tendencia: 'estavel' as const, percentual: 0 }","      const percentual = ((atual - anterior) / anterior) * 100","      if (percentual > 5) return { tendencia: 'crescimento' as const, percentual: Math.round(percentual * 100) / 100 }","      if (percentual < -5) return { tendencia: 'declinio' as const, percentual: Math.round(percentual * 100) / 100 }","      return { tendencia: 'estavel' as const, percentual: Math.round(percentual * 100) / 100 }","    }","    ","    // Sazonalidade","    const mesMaisAtivo = crescimentoMensal.reduce((max, m) => (m.inscricoes > max.inscricoes ? m : max), crescimentoMensal[0])","    const mesMenosAtivo = crescimentoMensal.reduce((min, m) => (m.inscricoes < min.inscricoes ? m : min), crescimentoMensal[0])","    const variacao = mesMaisAtivo.inscricoes > 0","      ? ((mesMaisAtivo.inscricoes - mesMenosAtivo.inscricoes) / mesMaisAtivo.inscricoes) * 100","      : 0","    ","    return {","      crescimentoMensal,","      projecaoProximos6Meses,","      tendenciasPorEixo: {","        work: calcularTendencia(inscricoesWork6Meses, inscricoesWork12Meses),","        edu: calcularTendencia(inscricoesEdu6Meses, inscricoesEdu12Meses),","        trilhas: calcularTendencia(inscricoesTrilhas6Meses, inscricoesTrilhas12Meses),","        lab: calcularTendencia(inscricoesLab6Meses, inscricoesLab12Meses),","      },","      sazonalidade: {","        mesMaisAtivo: mesMaisAtivo.mes,","        mesMenosAtivo: mesMenosAtivo.mes,","        variacao: Math.round(variacao * 100) / 100,","      },","    }","  }, 10 * 60 * 1000) // Cache de 10 minutos","}","","// ============================================","// 4. ANÁLISE DE DESEMPENHO TERRITORIAL","// ============================================","","export interface DesempenhoTerritorial {","  municipiosRanking: Array<{","    municipio: string","    rank: number","    totalAlunos: number","    totalCertificados: number","    taxaCertificacao: number","    distribuicaoPorEixo: {","      work: number","      edu: number","      trilhas: number","      lab: number","    }","    cobertura: {","      escolas: number","      empresas: number","      laboratorios: number","    }","  }>","  regioes: {","    norte: { total: number; municipios: string[] }","    sul: { total: number; municipios: string[] }","    leste: { total: number; municipios: string[] }","    oeste: { total: number; municipios: string[] }","    centro: { total: number; municipios: string[] }","  }","  municipiosComMaiorImpacto: Array<{","    municipio: string","    impacto: number // Score calculado","    criterios: {","      totalAlunos: number","      taxaCertificacao: number","      diversidadeEixos: number","      cobertura: number","    }","  }>","}","","export async function analisarDesempenhoTerritorial(): Promise<DesempenhoTerritorial> {","  const cacheKey = createCacheKey('bi-territorial', {})","  ","  return cachedQuery(queryCache, cacheKey, async () => {","    // Alunos por município","    const alunosPorMunicipio = await prisma.alunos.groupBy({","      by: ['municipio'],","      _count: true,","    })","    ","    // Certificados por município (via alunos)","    const certificadosPorMunicipio = new Map<string, number>()","    ","    // Work","    const contratacoes = await prisma.contratacoes.findMany({","      select: {","        candidaturas: {","          select: {","            alunos: {","              select: { municipio: true },","            },","          },","        },","      },","    })","    ","    contratacoes.forEach((c) => {","      const municipio = c.candidaturas?.alunos?.municipio || 'Não informado'","      certificadosPorMunicipio.set(municipio, (certificadosPorMunicipio.get(municipio) || 0) + 1)","    })","    ","    // Edu","    const matriculasEdu = await prisma.matriculas_oxetech_edu.findMany({","      where: { status: { not: 'ZERO' } },","      select: {","        alunos: {","          select: { municipio: true },","        },","      },","    })","    ","    matriculasEdu.forEach((m) => {","      const municipio = m.alunos?.municipio || 'Não informado'","      certificadosPorMunicipio.set(municipio, (certificadosPorMunicipio.get(municipio) || 0) + 1)","    })","    ","    // Trilhas","    const trilhasConcluidas = await prisma.inscricoes_trilhas_alunos.findMany({","      where: { concluido: true },","      select: {","        alunos: {","          select: { municipio: true },","        },","      },","    })","    ","    trilhasConcluidas.forEach((t) => {","      const municipio = t.alunos?.municipio || 'Não informado'","      certificadosPorMunicipio.set(municipio, (certificadosPorMunicipio.get(municipio) || 0) + 1)","    })","    ","    // Lab","    const labCertificados = await prisma.oxetechlab_inscricoes.findMany({","      where: { status: 'TWO' },","      select: {","        alunos: {","          select: { municipio: true },","        },","      },","    })","    ","    labCertificados.forEach((l) => {","      const municipio = l.alunos?.municipio || 'Não informado'","      certificadosPorMunicipio.set(municipio, (certificadosPorMunicipio.get(municipio) || 0) + 1)","    })","    ","    // Cobertura (escolas, empresas, laboratórios por município)","    const [","      escolasPorMunicipio,","      empresasPorMunicipio,","      laboratoriosPorMunicipio,","    ] = await Promise.all([","      prisma.escolas_oxetech_edu.groupBy({","        by: ['municipio'],","        _count: true,","      }),","      prisma.empresas.findMany({","        select: { endereco: true },","      }), // Ajustar conforme schema","      prisma.laboratorios.groupBy({","        by: ['municipio'],","        _count: true,","      }),","    ])","    ","    // Montar ranking","    const municipiosRanking = alunosPorMunicipio","      .map((m, index) => {","        const municipio = m.municipio || 'Não informado'","        const totalAlunos = m._count","        const totalCertificados = certificadosPorMunicipio.get(municipio) || 0","        const taxaCertificacao = totalAlunos > 0 ? (totalCertificados / totalAlunos) * 100 : 0","        ","        return {","          municipio,","          rank: index + 1,","          totalAlunos,","          totalCertificados,","          taxaCertificacao: Math.round(taxaCertificacao * 100) / 100,","          distribuicaoPorEixo: {","            work: 0, // Será calculado depois","            edu: 0,","            trilhas: 0,","            lab: 0,","          },","          cobertura: {","            escolas: escolasPorMunicipio.find((e) => e.municipio === municipio)?._count || 0,","            empresas: 0, // Ajustar conforme schema","            laboratorios: laboratoriosPorMunicipio.find((l) => l.municipio === municipio)?._count || 0,","          },","        }","      })","      .sort((a, b) => b.totalAlunos - a.totalAlunos)","      .slice(0, 20)","    ","    // Regiões (simulado - ajustar conforme mapeamento real de Alagoas)","    const regioes = {","      norte: { total: 0, municipios: [] as string[] },","      sul: { total: 0, municipios: [] as string[] },","      leste: { total: 0, municipios: [] as string[] },","      oeste: { total: 0, municipios: [] as string[] },","      centro: { total: 0, municipios: [] as string[] },","    }","    ","    // Mapeamento simplificado (ajustar conforme região real)","    const mapearRegiao = (municipio: string): keyof typeof regioes => {","      if (municipio.toLowerCase().includes('maceió') || municipio.toLowerCase().includes('marechal')) return 'leste'","      // Adicionar mais mapeamentos conforme necessário","      return 'centro'","    }","    ","    municipiosRanking.forEach((m) => {","      const regiao = mapearRegiao(m.municipio)","      regioes[regiao].total += m.totalAlunos","      if (!regioes[regiao].municipios.includes(m.municipio)) {","        regioes[regiao].municipios.push(m.municipio)","      }","    })","    ","    // Municípios com maior impacto (score)","    const municipiosComMaiorImpacto = municipiosRanking","      .map((m) => {","        const scoreImpacto =","          m.totalAlunos * 0.3 +","          m.taxaCertificacao * 0.4 +","          (m.cobertura.escolas + m.cobertura.laboratorios) * 10 * 0.2 +","          (m.distribuicaoPorEixo.work + m.distribuicaoPorEixo.edu + m.distribuicaoPorEixo.trilhas + m.distribuicaoPorEixo.lab > 0 ? 1 : 0) * 100 * 0.1","        ","        return {","          municipio: m.municipio,","          impacto: Math.round(scoreImpacto),","          criterios: {","            totalAlunos: m.totalAlunos,","            taxaCertificacao: m.taxaCertificacao,","            diversidadeEixos: m.distribuicaoPorEixo.work + m.distribuicaoPorEixo.edu + m.distribuicaoPorEixo.trilhas + m.distribuicaoPorEixo.lab,","            cobertura: m.cobertura.escolas + m.cobertura.laboratorios,","          },","        }","      })","      .sort((a, b) => b.impacto - a.impacto)","      .slice(0, 10)","    ","    return {","      municipiosRanking,","      regioes,","      municipiosComMaiorImpacto,","    }","  }, 15 * 60 * 1000) // Cache de 15 minutos","}","","// ============================================","// 5. ANÁLISE DE OPORTUNIDADES E GAPS","// ============================================","","export interface OportunidadesGaps {","  oportunidades: Array<{","    tipo: 'expansao' | 'melhoria' | 'novo_servico' | 'parceria'","    titulo: string","    descricao: string","    impacto: 'alto' | 'medio' | 'baixo'","    facilidade: 'alta' | 'media' | 'baixa'","    municipiosAlvos: string[]","  }>","  gaps: Array<{","    tipo: 'cobertura' | 'eficiência' | 'retenção' | 'qualidade'","    descricao: string","    severidade: 'alta' | 'media' | 'baixa'","    municipiosAfetados: string[]","    recomendacoes: string[]","  }>","  priorizacao: Array<{","    acao: string","    prioridade: number // 1-10","    razao: string","    impactoEsperado: string","  }>","}","","export async function analisarOportunidadesGaps(): Promise<OportunidadesGaps> {","  const cacheKey = createCacheKey('bi-oportunidades', {})","  ","  return cachedQuery(queryCache, cacheKey, async () => {","    // Análise de oportunidades","    const oportunidades: OportunidadesGaps['oportunidades'] = []","    ","    // Gaps","    const gaps: OportunidadesGaps['gaps'] = []","    ","    // Análise de cobertura","    const municipiosComAlunos = await prisma.alunos.groupBy({","      by: ['municipio'],","      _count: true,","    })","    ","    const municipiosComEscolas = await prisma.escolas_oxetech_edu.groupBy({","      by: ['municipio'],","      _count: true,","    })","    ","    const municipiosComLaboratorios = await prisma.laboratorios.groupBy({","      by: ['municipio'],","      _count: true,","    })","    ","    // Municípios sem cobertura","    const municipiosSemCobertura = municipiosComAlunos","      .filter((m) => {","        const temEscola = municipiosComEscolas.some((e) => e.municipio === m.municipio)","        const temLab = municipiosComLaboratorios.some((l) => l.municipio === m.municipio)","        return !temEscola && !temLab && m._count >= 10 // Pelo menos 10 alunos","      })","      .map((m) => m.municipio || 'Não informado')","    ","    if (municipiosSemCobertura.length > 0) {","      gaps.push({","        tipo: 'cobertura',","        descricao: `${municipiosSemCobertura.length} municípios com alunos mas sem escolas ou laboratórios`,","        severidade: 'alta',","        municipiosAfetados: municipiosSemCobertura.slice(0, 10),","        recomendacoes: [","          'Instalar pontos de atendimento nos municípios identificados',","          'Parcerias com escolas locais',","          'Programas itinerantes',","        ],","      })","      ","      oportunidades.push({","        tipo: 'expansao',","        titulo: 'Expansão para municípios sem cobertura',","        descricao: `Expandir serviços para ${municipiosSemCobertura.length} municípios que já possuem alunos cadastrados mas não têm pontos de atendimento`,","        impacto: 'alto',","        facilidade: 'media',","        municipiosAlvos: municipiosSemCobertura.slice(0, 10),","      })","    }","    ","    // Análise de evasão","    const matriculasEdu = await prisma.matriculas_oxetech_edu.count()","    const evasoesEdu = await prisma.matriculas_oxetech_edu.count({","      where: { status: 'ZERO' },","    })","    ","    const taxaEvasao = matriculasEdu > 0 ? (evasoesEdu / matriculasEdu) * 100 : 0","    ","    if (taxaEvasao > 20) {","      gaps.push({","        tipo: 'retenção',","        descricao: `Taxa de evasão alta no Edu: ${taxaEvasao.toFixed(1)}%`,","        severidade: 'alta',","        municipiosAfetados: [],","        recomendacoes: [","          'Programas de acompanhamento personalizado',","          'Gamificação e incentivos',","          'Mentoria e apoio psicossocial',","        ],","      })","      ","      oportunidades.push({","        tipo: 'melhoria',","        titulo: 'Programa de Retenção',","        descricao: 'Implementar programa específico para reduzir evasão no Edu',","        impacto: 'alto',","        facilidade: 'media',","        municipiosAlvos: [],","      })","    }","    ","    // Análise de taxa de conclusão Trilhas","    const trilhasInscricoes = await prisma.inscricoes_trilhas_alunos.count()","    const trilhasConcluidas = await prisma.inscricoes_trilhas_alunos.count({","      where: { concluido: true },","    })","    ","    const taxaConclusaoTrilhas = trilhasInscricoes > 0 ? (trilhasConcluidas / trilhasInscricoes) * 100 : 0","    ","    if (taxaConclusaoTrilhas < 50) {","      gaps.push({","        tipo: 'eficiência',","        descricao: `Taxa de conclusão baixa nas Trilhas: ${taxaConclusaoTrilhas.toFixed(1)}%`,","        severidade: 'media',","        municipiosAfetados: [],","        recomendacoes: [","          'Melhorar UX das trilhas',","          'Notificações e lembretes',","          'Conteúdo mais engajador',","        ],","      })","    }","    ","    // Análise de vagas não ocupadas (Lab)","    const turmasVagas = await prisma.turmas.findMany({","      select: {","        qtd_vagas_total: true,","        qtd_vagas_preenchidas: true,","        laboratorios: {","          select: { municipio: true },","        },","      },","    })","    ","    const vagasLivres = turmasVagas.reduce((acc, t) => {","      return acc + ((t.qtd_vagas_total || 0) - (t.qtd_vagas_preenchidas || 0))","    }, 0)","    ","    if (vagasLivres > 100) {","      oportunidades.push({","        tipo: 'expansao',","        titulo: 'Campanha de Divulgação Lab',","        descricao: `${vagasLivres} vagas disponíveis no Lab - oportunidade de expansão`,","        impacto: 'medio',","        facilidade: 'alta',","        municipiosAlvos: [],","      })","    }","    ","    // Priorização","    const priorizacao: OportunidadesGaps['priorizacao'] = [","      ...gaps","        .filter((g) => g.severidade === 'alta')","        .map((g) => ({","          acao: `Resolver gap: ${g.descricao}`,","          prioridade: 9,","          razao: 'Alta severidade',","          impactoEsperado: 'Redução de problemas críticos',","        })),","      ...oportunidades","        .filter((o) => o.impacto === 'alto')","        .map((o) => ({","          acao: o.titulo,","          prioridade: 8,","          razao: 'Alto impacto',","          impactoEsperado: 'Aumento significativo de resultados',","        })),","    ]","      .slice(0, 10)","      .sort((a, b) => b.prioridade - a.prioridade)","    ","    return {","      oportunidades,","      gaps,","      priorizacao,","    }","  }, 15 * 60 * 1000) // Cache de 15 minutos","}","","// ============================================","// 6. ANÁLISE DE ROI E EFICIÊNCIA ORÇAMENTÁRIA","// ============================================","","export interface ROIEficiencia {","  investimentoPorAluno: {","    work: number","    edu: number","    trilhas: number","    lab: number","    media: number","  }","  custoPorCertificado: {","    work: number","    edu: number","    trilhas: number","    lab: number","    media: number","  }","  eficienciaOrcamentaria: {","    orcamentoUsado: number // %","    orcamentoRestante: number // %","    projecaoGasto: number","    mesesRestantes: number","  }","  comparacaoEixos: Array<{","    eixo: string","    investimento: number","    retorno: number // certificados","    eficiencia: number // certificados por R$ 1000","  }>","}","","export async function analisarROIEficiencia(): Promise<ROIEficiencia> {","  const cacheKey = createCacheKey('bi-roi', {})","  ","  return cachedQuery(queryCache, cacheKey, async () => {","    // Dados simulados - ajustar conforme dados reais de orçamento","    const orcamentoTotal = 10000000 // R$ 10 milhões (simulado)","    const orcamentoUsado = 6500000 // R$ 6.5 milhões (simulado)","    ","    // Participantes e certificados","    const [","      participantesWork,","      certificadosWork,","      participantesEdu,","      certificadosEdu,","      participantesTrilhas,","      certificadosTrilhas,","      participantesLab,","      certificadosLab,","    ] = await Promise.all([","      prisma.oxetechwork_inscricao_alunos.count(),","      prisma.contratacoes.count(),","      prisma.matriculas_oxetech_edu.count(),","      prisma.matriculas_oxetech_edu.count({ where: { status: { not: 'ZERO' } } }),","      prisma.inscricoes_trilhas_alunos.count(),","      prisma.inscricoes_trilhas_alunos.count({ where: { concluido: true } }),","      prisma.oxetechlab_inscricoes.count(),","      prisma.oxetechlab_inscricoes.count({ where: { status: 'TWO' } }),","    ])","    ","    // Distribuição de orçamento (simulado - ajustar conforme real)","    const orcamentoWork = orcamentoUsado * 0.4","    const orcamentoEdu = orcamentoUsado * 0.25","    const orcamentoTrilhas = orcamentoUsado * 0.15","    const orcamentoLab = orcamentoUsado * 0.2","    ","    // Investimento por aluno","    const investimentoPorAluno = {","      work: participantesWork > 0 ? orcamentoWork / participantesWork : 0,","      edu: participantesEdu > 0 ? orcamentoEdu / participantesEdu : 0,","      trilhas: participantesTrilhas > 0 ? orcamentoTrilhas / participantesTrilhas : 0,","      lab: participantesLab > 0 ? orcamentoLab / participantesLab : 0,","      media: 0,","    }","    ","    investimentoPorAluno.media =","      (investimentoPorAluno.work +","        investimentoPorAluno.edu +","        investimentoPorAluno.trilhas +","        investimentoPorAluno.lab) /","      4","    ","    // Custo por certificado","    const custoPorCertificado = {","      work: certificadosWork > 0 ? orcamentoWork / certificadosWork : 0,","      edu: certificadosEdu > 0 ? orcamentoEdu / certificadosEdu : 0,","      trilhas: certificadosTrilhas > 0 ? orcamentoTrilhas / certificadosTrilhas : 0,","      lab: certificadosLab > 0 ? orcamentoLab / certificadosLab : 0,","      media: 0,","    }","    ","    custoPorCertificado.media =","      (custoPorCertificado.work +","        custoPorCertificado.edu +","        custoPorCertificado.trilhas +","        custoPorCertificado.lab) /","      4","    ","    // Eficiência orçamentária","    const hoje = new Date()","    const mesAtual = hoje.getMonth()","    const mesesRestantes = 12 - mesAtual","    ","    const taxaGastoMensal = orcamentoUsado / (mesAtual + 1)","    const projecaoGasto = taxaGastoMensal * 12","    ","    // Comparação entre eixos (eficiencia = certificados por R$ 1000)","    const comparacaoEixos = [","      {","        eixo: 'Work',","        investimento: orcamentoWork,","        retorno: certificadosWork,","        eficiencia: orcamentoWork > 0 ? (certificadosWork / orcamentoWork) * 1000 : 0,","      },","      {","        eixo: 'Edu',","        investimento: orcamentoEdu,","        retorno: certificadosEdu,","        eficiencia: orcamentoEdu > 0 ? (certificadosEdu / orcamentoEdu) * 1000 : 0,","      },","      {","        eixo: 'Trilhas',","        investimento: orcamentoTrilhas,","        retorno: certificadosTrilhas,","        eficiencia: orcamentoTrilhas > 0 ? (certificadosTrilhas / orcamentoTrilhas) * 1000 : 0,","      },","      {","        eixo: 'Lab',","        investimento: orcamentoLab,","        retorno: certificadosLab,","        eficiencia: orcamentoLab > 0 ? (certificadosLab / orcamentoLab) * 1000 : 0,","      },","    ].sort((a, b) => b.eficiencia - a.eficiencia)","    ","    return {","      investimentoPorAluno: {","        work: Math.round(investimentoPorAluno.work),","        edu: Math.round(investimentoPorAluno.edu),","        trilhas: Math.round(investimentoPorAluno.trilhas),","        lab: Math.round(investimentoPorAluno.lab),","        media: Math.round(investimentoPorAluno.media),","      },","      custoPorCertificado: {","        work: Math.round(custoPorCertificado.work),","        edu: Math.round(custoPorCertificado.edu),","        trilhas: Math.round(custoPorCertificado.trilhas),","        lab: Math.round(custoPorCertificado.lab),","        media: Math.round(custoPorCertificado.media),","      },","      eficienciaOrcamentaria: {","        orcamentoUsado: (orcamentoUsado / orcamentoTotal) * 100,","        orcamentoRestante: ((orcamentoTotal - orcamentoUsado) / orcamentoTotal) * 100,","        projecaoGasto,","        mesesRestantes,","      },","      comparacaoEixos: comparacaoEixos.map((e) => ({","        ...e,","        eficiencia: Math.round(e.eficiencia * 100) / 100,","      })),","    }","  }, 15 * 60 * 1000) // Cache de 15 minutos","}","","// ============================================","// 7. ANÁLISE COMPLETA DE BI","// ============================================","","export interface AnaliseCompletaBI {","  impactoSocial: ImpactoSocial","  eficaciaProgramas: EficaciaProgramas","  tendenciasProjecoes: TendenciasProjecoes","  desempenhoTerritorial: DesempenhoTerritorial","  oportunidadesGaps: OportunidadesGaps","  roiEficiencia: ROIEficiencia","  resumoExecutivo: {","    principaisInsights: string[]","    recomendacoesPrioritarias: string[]","    alertasCriticos: string[]","    destaques: string[]","  }","}","","export async function gerarAnaliseCompletaBI(): Promise<AnaliseCompletaBI> {","  const [","    impactoSocial,","    eficaciaProgramas,","    tendenciasProjecoes,","    desempenhoTerritorial,","    oportunidadesGaps,","    roiEficiencia,","  ] = await Promise.all([","    analisarImpactoSocial(),","    analisarEficaciaProgramas(),","    analisarTendenciasProjecoes(),","    analisarDesempenhoTerritorial(),","    analisarOportunidadesGaps(),","    analisarROIEficiencia(),","  ])","  ","  // Gerar resumo executivo","  const principaisInsights: string[] = []","  const recomendacoesPrioritarias: string[] = []","  const alertasCriticos: string[] = []","  const destaques: string[] = []","  ","  // Insights","  principaisInsights.push(","    `Taxa de empregabilidade de ${impactoSocial.taxaEmpregabilidade.toFixed(1)}%`,","    `${impactoSocial.totalCertificados} alunos certificados em todos os eixos`,","    `Cobertura em ${impactoSocial.totalMunicipiosAtendidos} municípios de Alagoas`,","    `Taxa de conclusão nas Trilhas: ${eficaciaProgramas.trilhas.taxaConclusao.toFixed(1)}%`","  )","  ","  // Alertas","  if (eficaciaProgramas.edu.taxaEvasao > 20) {","    alertasCriticos.push(`Evasão alta no Edu: ${eficaciaProgramas.edu.taxaEvasao.toFixed(1)}%`)","  }","  ","  if (eficaciaProgramas.lab.taxaOcupacao < 70) {","    alertasCriticos.push(`Taxa de ocupação baixa no Lab: ${eficaciaProgramas.lab.taxaOcupacao.toFixed(1)}%`)","  }","  ","  // Destaques","  const eixoMaisEficiente = roiEficiencia.comparacaoEixos[0]","  destaques.push(`${eixoMaisEficiente.eixo} é o eixo mais eficiente: ${eixoMaisEficiente.eficiencia} certificados por R$ 1000`)","  ","  const municipioTop = desempenhoTerritorial.municipiosRanking[0]","  destaques.push(`${municipioTop.municipio} lidera em número de alunos: ${municipioTop.totalAlunos}`)","  ","  // Recomendações","  oportunidadesGaps.priorizacao.slice(0, 5).forEach((p) => {","    recomendacoesPrioritarias.push(`${p.acao}: ${p.razao}`)","  })","  ","  return {","    impactoSocial,","    eficaciaProgramas,","    tendenciasProjecoes,","    desempenhoTerritorial,","    oportunidadesGaps,","    roiEficiencia,","    resumoExecutivo: {","      principaisInsights,","      recomendacoesPrioritarias,","      alertasCriticos,","      destaques,","    },","  }","}","",""],"tokenizedAddedLines":[1000000,1000001,1000002,1000003,1000004,1000005,1000006,1000007,1000008,1000009,1000010,1000006,1000011,1000012,1000011,1000006,1000013,1000014,1000015,1000016,1000017,1000018,1000019,1000020,1000021,1000022,1000023,1000024,1000025,1000026,1000027,1000028,1000029,1000030,1000031,1000032,1000033,1000034,1000035,1000029,1000036,1000037,1000038,1000039,1000040,1000024,1000041,1000006,1000042,1000043,1000044,1000045,1000046,1000047,1000048,1000049,1000050,1000051,1000052,1000053,1000048,1000054,1000055,1000056,1000052,1000053,1000048,1000057,1000058,1000059,1000060,1000061,1000053,1000048,1000062,1000063,1000064,1000065,1000066,1000067,1000068,1000069,1000070,1000048,1000071,1000072,1000073,1000074,1000075,1000076,1000077,1000078,1000079,1000053,1000048,1000080,1000081,1000082,1000083,1000084,1000085,1000086,1000087,1000088,1000089,1000090,1000091,1000092,1000093,1000048,1000094,1000095,1000096,1000097,1000098,1000099,1000061,1000053,1000048,1000100,1000101,1000102,1000103,1000053,1000048,1000104,1000105,1000106,1000053,1000048,1000107,1000105,1000106,1000053,1000048,1000108,1000109,1000110,1000053,1000111,1000112,1000053,1000113,1000112,1000053,1000048,1000114,1000115,1000116,1000117,1000118,1000119,1000120,1000121,1000122,1000123,1000124,1000125,1000126,1000121,1000048,1000127,1000128,1000129,1000130,1000131,1000048,1000132,1000133,1000134,1000135,1000136,1000137,1000070,1000048,1000138,1000139,1000140,1000141,1000142,1000048,1000143,1000144,1000145,1000146,1000147,1000148,1000149,1000150,1000151,1000152,1000153,1000154,1000155,1000156,1000157,1000158,1000159,1000160,1000061,1000070,1000161,1000041,1000006,1000011,1000162,1000011,1000006,1000163,1000164,1000165,1000166,1000167,1000168,1000169,1000170,1000024,1000171,1000172,1000173,1000174,1000175,1000176,1000024,1000177,1000178,1000179,1000180,1000181,1000024,1000182,1000183,1000174,1000184,1000185,1000024,1000041,1000006,1000186,1000187,1000044,1000045,1000188,1000081,1000189,1000190,1000191,1000192,1000086,1000193,1000194,1000195,1000090,1000196,1000197,1000093,1000048,1000198,1000199,1000200,1000131,1000048,1000201,1000202,1000203,1000204,1000205,1000206,1000048,1000207,1000208,1000209,1000048,1000210,1000211,1000212,1000048,1000213,1000214,1000048,1000215,1000081,1000216,1000217,1000218,1000086,1000219,1000220,1000221,1000222,1000223,1000224,1000225,1000226,1000227,1000228,1000229,1000099,1000090,1000230,1000231,1000090,1000232,1000233,1000090,1000093,1000048,1000234,1000235,1000236,1000048,1000237,1000238,1000048,1000239,1000240,1000048,1000241,1000242,1000243,1000244,1000245,1000053,1000048,1000246,1000247,1000248,1000249,1000121,1000250,1000251,1000048,1000252,1000081,1000253,1000254,1000086,1000255,1000220,1000256,1000222,1000257,1000258,1000259,1000229,1000099,1000090,1000255,1000260,1000220,1000222,1000257,1000258,1000259,1000229,1000099,1000090,1000093,1000048,1000261,1000262,1000131,1000048,1000263,1000264,1000265,1000266,1000267,1000131,1000048,1000268,1000269,1000270,1000271,1000272,1000053,1000048,1000273,1000274,1000275,1000276,1000121,1000277,1000251,1000048,1000278,1000279,1000096,1000280,1000281,1000282,1000099,1000061,1000053,1000048,1000283,1000081,1000284,1000285,1000286,1000086,1000287,1000288,1000220,1000289,1000290,1000291,1000099,1000090,1000292,1000220,1000221,1000293,1000224,1000294,1000295,1000296,1000228,1000229,1000099,1000090,1000093,1000048,1000297,1000298,1000299,1000048,1000300,1000301,1000048,1000302,1000303,1000304,1000305,1000306,1000053,1000048,1000307,1000308,1000248,1000309,1000121,1000310,1000251,1000048,1000143,1000311,1000312,1000313,1000314,1000315,1000316,1000317,1000061,1000318,1000319,1000320,1000321,1000322,1000323,1000061,1000324,1000325,1000326,1000327,1000328,1000061,1000329,1000330,1000331,1000332,1000333,1000061,1000070,1000161,1000041,1000006,1000011,1000334,1000011,1000006,1000335,1000336,1000337,1000338,1000339,1000340,1000029,1000341,1000338,1000339,1000342,1000024,1000343,1000344,1000345,1000346,1000347,1000024,1000348,1000349,1000350,1000351,1000024,1000041,1000006,1000352,1000353,1000044,1000045,1000354,1000355,1000356,1000048,1000357,1000358,1000359,1000360,1000361,1000362,1000363,1000070,1000048,1000364,1000365,1000366,1000367,1000368,1000369,1000370,1000371,1000372,1000373,1000374,1000370,1000375,1000376,1000377,1000378,1000379,1000380,1000381,1000382,1000383,1000384,1000385,1000386,1000387,1000388,1000389,1000227,1000228,1000390,1000391,1000386,1000387,1000388,1000389,1000227,1000228,1000390,1000392,1000386,1000387,1000388,1000389,1000227,1000228,1000390,1000393,1000386,1000387,1000388,1000389,1000227,1000228,1000390,1000394,1000386,1000387,1000388,1000389,1000227,1000228,1000390,1000391,1000386,1000387,1000388,1000389,1000227,1000395,1000228,1000390,1000392,1000386,1000387,1000388,1000389,1000227,1000396,1000228,1000390,1000393,1000386,1000387,1000388,1000389,1000227,1000397,1000228,1000390,1000398,1000370,1000399,1000400,1000370,1000401,1000402,1000403,1000404,1000405,1000406,1000363,1000407,1000048,1000408,1000409,1000410,1000411,1000412,1000413,1000414,1000415,1000416,1000053,1000048,1000417,1000418,1000419,1000420,1000048,1000421,1000422,1000131,1000048,1000423,1000424,1000425,1000426,1000070,1000048,1000427,1000203,1000204,1000205,1000206,1000048,1000081,1000428,1000429,1000430,1000431,1000432,1000433,1000434,1000435,1000086,1000436,1000437,1000090,1000436,1000438,1000439,1000440,1000441,1000229,1000099,1000090,1000088,1000437,1000090,1000088,1000438,1000439,1000440,1000441,1000229,1000099,1000090,1000442,1000437,1000090,1000442,1000438,1000439,1000440,1000441,1000229,1000099,1000090,1000443,1000437,1000090,1000443,1000438,1000439,1000440,1000441,1000229,1000099,1000090,1000093,1000048,1000444,1000445,1000446,1000447,1000448,1000449,1000070,1000048,1000450,1000451,1000452,1000453,1000454,1000131,1000048,1000143,1000455,1000456,1000457,1000458,1000459,1000460,1000461,1000061,1000462,1000463,1000464,1000465,1000061,1000070,1000161,1000041,1000006,1000011,1000466,1000011,1000006,1000467,1000468,1000031,1000035,1000032,1000034,1000174,1000469,1000470,1000471,1000472,1000473,1000070,1000474,1000475,1000476,1000477,1000070,1000029,1000478,1000479,1000480,1000481,1000482,1000483,1000024,1000484,1000031,1000485,1000486,1000487,1000488,1000489,1000490,1000070,1000029,1000041,1000006,1000491,1000492,1000044,1000045,1000054,1000055,1000056,1000052,1000053,1000048,1000493,1000494,1000048,1000495,1000496,1000059,1000497,1000498,1000499,1000500,1000228,1000229,1000099,1000061,1000053,1000048,1000501,1000502,1000503,1000053,1000048,1000504,1000505,1000506,1000059,1000507,1000508,1000099,1000061,1000053,1000048,1000243,1000509,1000503,1000053,1000048,1000510,1000511,1000512,1000059,1000507,1000508,1000099,1000061,1000053,1000048,1000270,1000513,1000503,1000053,1000048,1000514,1000515,1000516,1000059,1000507,1000508,1000099,1000061,1000053,1000048,1000517,1000518,1000503,1000053,1000048,1000519,1000081,1000520,1000521,1000522,1000086,1000523,1000524,1000525,1000090,1000526,1000527,1000528,1000529,1000524,1000525,1000090,1000093,1000048,1000530,1000115,1000531,1000532,1000533,1000534,1000535,1000370,1000401,1000536,1000537,1000538,1000539,1000540,1000541,1000542,1000543,1000544,1000545,1000229,1000546,1000547,1000548,1000549,1000229,1000406,1000363,1000122,1000123,1000048,1000550,1000551,1000552,1000553,1000554,1000555,1000556,1000070,1000048,1000557,1000558,1000559,1000560,1000561,1000070,1000048,1000562,1000563,1000564,1000565,1000566,1000416,1000053,1000048,1000567,1000568,1000569,1000570,1000571,1000572,1000573,1000574,1000370,1000401,1000575,1000576,1000577,1000578,1000579,1000580,1000581,1000229,1000406,1000363,1000582,1000251,1000048,1000143,1000583,1000584,1000585,1000070,1000586,1000041,1000006,1000011,1000587,1000011,1000006,1000588,1000589,1000590,1000591,1000592,1000593,1000594,1000595,1000029,1000596,1000597,1000592,1000598,1000599,1000600,1000029,1000601,1000602,1000603,1000604,1000605,1000029,1000041,1000006,1000606,1000607,1000044,1000045,1000608,1000609,1000048,1000610,1000611,1000048,1000612,1000613,1000056,1000052,1000053,1000048,1000614,1000056,1000052,1000053,1000048,1000615,1000056,1000052,1000053,1000048,1000616,1000617,1000618,1000619,1000620,1000621,1000363,1000622,1000048,1000623,1000624,1000625,1000626,1000627,1000628,1000629,1000630,1000631,1000632,1000633,1000363,1000634,1000635,1000636,1000637,1000638,1000639,1000640,1000641,1000363,1000070,1000048,1000642,1000643,1000644,1000645,1000053,1000048,1000646,1000048,1000647,1000624,1000648,1000649,1000627,1000650,1000629,1000651,1000652,1000653,1000633,1000363,1000634,1000635,1000654,1000655,1000656,1000639,1000640,1000657,1000363,1000070,1000048,1000658,1000659,1000660,1000512,1000053,1000048,1000661,1000048,1000662,1000624,1000663,1000664,1000665,1000650,1000629,1000666,1000667,1000668,1000633,1000363,1000070,1000048,1000669,1000670,1000059,1000671,1000672,1000673,1000508,1000099,1000061,1000053,1000048,1000674,1000675,1000676,1000048,1000677,1000635,1000636,1000678,1000679,1000680,1000681,1000657,1000363,1000070,1000048,1000682,1000683,1000684,1000685,1000686,1000687,1000688,1000689,1000690,1000691,1000692,1000693,1000694,1000695,1000696,1000697,1000698,1000691,1000699,1000251,1000700,1000048,1000143,1000701,1000702,1000703,1000070,1000586,1000041,1000006,1000011,1000704,1000011,1000006,1000705,1000706,1000707,1000708,1000709,1000710,1000711,1000024,1000712,1000707,1000708,1000709,1000710,1000711,1000024,1000713,1000714,1000715,1000716,1000717,1000024,1000718,1000719,1000720,1000721,1000722,1000029,1000041,1000006,1000723,1000724,1000044,1000045,1000725,1000726,1000727,1000048,1000728,1000081,1000729,1000082,1000730,1000083,1000731,1000084,1000732,1000085,1000086,1000193,1000087,1000733,1000734,1000735,1000091,1000287,1000092,1000093,1000048,1000736,1000737,1000738,1000739,1000740,1000048,1000741,1000742,1000743,1000744,1000745,1000746,1000747,1000070,1000048,1000748,1000749,1000750,1000751,1000752,1000753,1000048,1000754,1000755,1000756,1000757,1000758,1000759,1000747,1000070,1000048,1000760,1000761,1000762,1000763,1000764,1000753,1000048,1000765,1000356,1000766,1000767,1000048,1000768,1000769,1000048,1000770,1000771,1000772,1000773,1000774,1000775,1000776,1000061,1000772,1000777,1000778,1000779,1000780,1000061,1000772,1000781,1000782,1000783,1000784,1000061,1000772,1000785,1000786,1000787,1000788,1000061,1000789,1000048,1000143,1000790,1000791,1000792,1000793,1000794,1000795,1000061,1000796,1000797,1000798,1000799,1000800,1000801,1000061,1000802,1000803,1000804,1000805,1000806,1000061,1000807,1000808,1000809,1000154,1000070,1000586,1000041,1000006,1000011,1000810,1000011,1000006,1000811,1000812,1000813,1000814,1000815,1000816,1000817,1000818,1000819,1000820,1000821,1000822,1000024,1000041,1000006,1000823,1000824,1000825,1000826,1000827,1000828,1000829,1000830,1000831,1000832,1000833,1000834,1000835,1000836,1000837,1000838,1000044,1000839,1000840,1000841,1000842,1000843,1000044,1000844,1000845,1000846,1000847,1000848,1000849,1000850,1000044,1000851,1000852,1000853,1000024,1000044,1000854,1000855,1000024,1000044,1000856,1000857,1000858,1000044,1000859,1000860,1000044,1000861,1000862,1000863,1000864,1000044,1000865,1000825,1000826,1000827,1000828,1000829,1000830,1000866,1000867,1000868,1000869,1000870,1000871,1000024,1000041,1000006,1000006]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_ADDED"}