{"fsPath":"\\home\\oxetech_mcz\\app\\api\\home\\route.ts","fileUuid":"cb24a79e-9e67-40cc-964d-215dd05bc1fa","fileSizeBytes":5758,"numLines":220,"diffChanges":[{"originalStartLineNumberOneIndexed":39,"originalEndLineNumberExclusiveOneIndexed":40,"modifiedStartLineNumberOneIndexed":39,"modifiedEndLineNumberExclusiveOneIndexed":81,"addedLines":["    // Últimos 12 meses - evolução de alunos","    const dozeMesesAtras = new Date()","    dozeMesesAtras.setMonth(dozeMesesAtras.getMonth() - 12)","","    const alunos12Meses = await prisma.alunos.findMany({","      where: {","        created_at: {","          gte: dozeMesesAtras,","        },","      },","      select: {","        created_at: true,","      },","      orderBy: {","        created_at: 'asc',","      },","    })","","    // Agrupar por mês (últimos 12 meses)","    const meses = []","    for (let i = 11; i >= 0; i--) {","      const data = new Date()","      data.setMonth(data.getMonth() - i)","      meses.push(data)","    }","","    const evolucao12Meses = meses.map((mes) => {","      const inicioMes = new Date(mes.getFullYear(), mes.getMonth(), 1)","      const fimMes = new Date(mes.getFullYear(), mes.getMonth() + 1, 0)","","      const total = alunos12Meses.filter((aluno) => {","        const dataAluno = new Date(aluno.created_at)","        return dataAluno >= inicioMes && dataAluno <= fimMes","      }).length","","      return {","        mes: mes.toLocaleDateString('pt-BR', { month: 'short', year: 'numeric' }),","        alunos: total,","      }","    })","","    // Evolução mensal completa de alunos"],"tokenizedAddedLines":[1000112,1000113,1000114,3,1000115,74,1000116,1000117,81,41,39,40,41,42,43,41,44,3,1000118,1000119,1000120,1000121,1000122,1000123,71,3,1000124,1000125,1000126,3,1000127,1000128,1000129,1000130,3,1000131,1000132,1000133,1000134,44,3,1000135]},{"originalStartLineNumberOneIndexed":58,"originalEndLineNumberExclusiveOneIndexed":60,"modifiedStartLineNumberOneIndexed":99,"modifiedEndLineNumberExclusiveOneIndexed":102,"addedLines":["    const evolucaoAlunosArray = Object.entries(evolucaoAlunos)","      .slice(-12)","      .map(([mes, total]) => ({"],"tokenizedAddedLines":[1000136,1000137,1000138]},{"originalStartLineNumberOneIndexed":62,"originalEndLineNumberExclusiveOneIndexed":64,"modifiedStartLineNumberOneIndexed":104,"modifiedEndLineNumberExclusiveOneIndexed":105,"addedLines":["      }))"],"tokenizedAddedLines":[1000139]},{"originalStartLineNumberOneIndexed":84,"originalEndLineNumberExclusiveOneIndexed":85,"modifiedStartLineNumberOneIndexed":125,"modifiedEndLineNumberExclusiveOneIndexed":128,"addedLines":["    const evolucaoWorkArray = Object.entries(evolucaoWork)","      .slice(-12)","      .map(([mes, inscricoes]) => ({"],"tokenizedAddedLines":[1000140,1000137,1000141]},{"originalStartLineNumberOneIndexed":86,"originalEndLineNumberExclusiveOneIndexed":87,"modifiedStartLineNumberOneIndexed":129,"modifiedEndLineNumberExclusiveOneIndexed":130,"addedLines":["        inscricoes,"],"tokenizedAddedLines":[1000142]},{"originalStartLineNumberOneIndexed":117,"originalEndLineNumberExclusiveOneIndexed":119,"modifiedStartLineNumberOneIndexed":160,"modifiedEndLineNumberExclusiveOneIndexed":162,"addedLines":["    const conclusaoTrilhasArray = Object.entries(conclusaoTrilhas)","      .map(([trilha, total]) => ({"],"tokenizedAddedLines":[1000143,1000144]},{"originalStartLineNumberOneIndexed":121,"originalEndLineNumberExclusiveOneIndexed":123,"modifiedStartLineNumberOneIndexed":164,"modifiedEndLineNumberExclusiveOneIndexed":185,"addedLines":["      }))","      .sort((a, b) => b.total - a.total)","      .slice(0, 10)","","    // Municípios atendidos","    const alunosMunicipios = await prisma.alunos.findMany({","      select: {","        municipio: true,","      },","      distinct: ['municipio'],","    })","","    const totalMunicipios = alunosMunicipios.length","","    // Distribuição por programa","    const distribuicaoPrograma = {","      work: totalInscricoesWork,","      edu: totalMatriculasEdu,","      lab: await prisma.oxetechlab_inscricoes.count(),","      trilhas: await prisma.inscricoes_trilhas_alunos.count(),","    }"],"tokenizedAddedLines":[1000139,1000145,1000146,3,1000147,1000148,39,1000149,41,1000150,44,3,1000151,3,1000152,1000153,1000154,1000155,1000156,1000157,71]},{"originalStartLineNumberOneIndexed":125,"originalEndLineNumberExclusiveOneIndexed":125,"modifiedStartLineNumberOneIndexed":187,"modifiedEndLineNumberExclusiveOneIndexed":188,"addedLines":["      data: {"],"tokenizedAddedLines":[1000158]},{"originalStartLineNumberOneIndexed":138,"originalEndLineNumberExclusiveOneIndexed":138,"modifiedStartLineNumberOneIndexed":201,"modifiedEndLineNumberExclusiveOneIndexed":202,"addedLines":["          totalMunicipios,"],"tokenizedAddedLines":[1000159]},{"originalStartLineNumberOneIndexed":139,"originalEndLineNumberExclusiveOneIndexed":139,"modifiedStartLineNumberOneIndexed":203,"modifiedEndLineNumberExclusiveOneIndexed":204,"addedLines":["        evolucao12Meses,"],"tokenizedAddedLines":[1000160]},{"originalStartLineNumberOneIndexed":143,"originalEndLineNumberExclusiveOneIndexed":143,"modifiedStartLineNumberOneIndexed":208,"modifiedEndLineNumberExclusiveOneIndexed":211,"addedLines":["        distribuicaoPrograma,","      },","      error: null,"],"tokenizedAddedLines":[1000161,41,1000162]},{"originalStartLineNumberOneIndexed":147,"originalEndLineNumberExclusiveOneIndexed":148,"modifiedStartLineNumberOneIndexed":215,"modifiedEndLineNumberExclusiveOneIndexed":216,"addedLines":["      { data: null, error: 'Failed to fetch home data' },"],"tokenizedAddedLines":[1000163]},{"originalStartLineNumberOneIndexed":152,"originalEndLineNumberExclusiveOneIndexed":153,"modifiedStartLineNumberOneIndexed":220,"modifiedEndLineNumberExclusiveOneIndexed":220}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}